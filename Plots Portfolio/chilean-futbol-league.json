{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "title": {
    "text": "Chilean League 2025 - Title Race",
    "subtitle": "Hover over points to see match details",
    "fontSize": 20,
    "subtitleFontSize": 13,
    "subtitleColor": "#666"
  },
  "width": 800,
  "height": 600,
  "background": "#fdfcfa",
  "data": {
    "url": "https://raw.githubusercontent.com/alonsoquezadar/alonsoquezadar.github.io/refs/heads/main/Plots%20Portfolio/Datasets/puntos_con_partidos_chile_2025.csv"
  },
  "transform": [
    {"filter": "datum.equipo != 'Deportes La serena'"},
    {
      "calculate": "indexof(['Coquimbo Unido', 'Universidad Cat贸lica', 'Universidad de Chile', 'Colo Colo', 'O\\'Higgins'], datum.equipo) >= 0",
      "as": "destacado"
    }
  ],
  "layer": [
    {
      "transform": [{"filter": "!datum.destacado"}],
      "mark": {"type": "line", "interpolate": "step-after", "strokeWidth": 1.5, "opacity": 0.25},
      "encoding": {
        "x": {"field": "partido", "type": "quantitative"},
        "y": {"field": "puntos_acumulados", "type": "quantitative"},
        "color": {"value": "#999999"},
        "detail": {"field": "equipo"}
      }
    },
    {
      "transform": [{"filter": "datum.destacado"}],
      "mark": {
        "type": "line", 
        "interpolate": "step-after", 
        "strokeWidth": 3,
        "point": {"filled": true, "size": 60}
      },
      "encoding": {
        "x": {"field": "partido", "type": "quantitative"},
        "y": {"field": "puntos_acumulados", "type": "quantitative"},
        "color": {
          "field": "equipo",
          "type": "nominal",
          "scale": {
            "domain": ["Coquimbo Unido", "Universidad Cat贸lica", "Universidad de Chile", "Colo Colo", "O'Higgins"],
            "range": ["#D4AF37", "#57B9FF", "#0047AB", "#1a1a1a", "#2E8B57"]
          },
          "legend": null
        },
        "tooltip": [
          {"field": "equipo", "title": "Team"},
          {"field": "partido", "title": "Matchday"},
          {"field": "rival", "title": "Opponent"},
          {"field": "resultado", "title": "Score"},
          {"field": "local_visita", "title": "Home/Away"},
          {"field": "resultado_texto", "title": "Result"},
          {"field": "puntos", "title": "Points gained"},
          {"field": "puntos_acumulados", "title": "Total Points"}
        ]
      }
    },
    {
      "transform": [
        {"filter": "datum.destacado"},
        {"filter": "datum.partido == 28 && datum.equipo == 'Coquimbo Unido' || datum.partido == 29 && datum.equipo == 'Universidad Cat贸lica' || datum.partido == 28 && datum.equipo == 'Universidad de Chile' || datum.partido == 29 && datum.equipo == 'Colo Colo' || datum.partido == 28 && datum.equipo == 'O\\'Higgins'"}
      ],
      "mark": {"type": "text", "align": "left", "dx": 8, "fontSize": 11, "fontWeight": "bold"},
      "encoding": {
        "x": {"field": "partido", "type": "quantitative"},
        "y": {"field": "puntos_acumulados", "type": "quantitative"},
        "text": {"field": "equipo"},
        "color": {
          "field": "equipo",
          "type": "nominal",
          "scale": {
            "domain": ["Coquimbo Unido", "Universidad Cat贸lica", "Universidad de Chile", "Colo Colo", "O'Higgins"],
            "range": ["#D4AF37", "#57B9FF", "#0047AB", "#1a1a1a", "#2E8B57"]
          }
        }
      }
    }
  ],
  "encoding": {
    "x": {
      "scale": {"domain": [0, 38]},
      "axis": {"grid": false, "title": "Matchday"}
    },
    "y": {
      "scale": {"domain": [0, 75]},
      "axis": {"grid": true, "gridColor": "#e0e0e0", "title": "Cumulative Points"}
    }
  },
  "config": {
    "view": {"stroke": null}
  }
}